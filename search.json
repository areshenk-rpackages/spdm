[{"path":"areshenk-rpackages.github.io/spdm/articles/functions/centering/center_guide.html","id":"tutorial","dir":"Articles > Functions > Centering","previous_headings":"","what":"Tutorial","title":"Centering covariance matrices","text":"spdm includes sample neuroimaging dataset containing standardized BOLD timecourses 5 subjects 5 different conditions. dataframe contains fields Subject Condition, well Data field containing list matrices (n_timepoints x n_regions). simple workflow, might begin computing covariance timecourses: visualization aid, sometimes useful create kind low-dimensional representation data. Multidimensional scaling case, ’ll construct distance matrix using pairwise geodesic distances covariance matrix. moment, spd.dist computes distance single pair (.e. bulk), ’ll borrow proxy packages order compute efficiently: plot embedded covariance matrices colored subject see phenomenon widely replicated neuroimaging literature: clustering covariance matrices within subjects:  , functional connectivity measured subject different task conditions similar task condition measured different subjects (see Gratton et al. 2018). fact, finding can replicated fairly extreme conditions; example, Areshenkoff et al.  (2021) find similar clustering Macaques different doses anesthesia. true even comparing nearly awake scans animal totally sedated. actual cause clustering debated, likely two general reasons: 1) Functional connectivity strongly constrained structural connectivity, variable across subjects; 2) Group average parcellations capture functional heterogeneity cortex, (fine parcellations) parcel cortex slightly different functions across subjects. Either way, result actual task differences functional connectivity buried much larger static inter-subject differences. sensible strategy case remove average subject differences “translating” covariance matrices subject means align common reference point (generally, grand mean). quite simple spd.center() function, accepts dataframe observation information, list covariance matrices, various constraints defining centering. case, need align subjects, specifying group_by = \"Subject\" enough. now subject clustering abolished.  side note, many analyses better conducted tangent vectors around grand mean (, centered covariance matrices projected onto tangent space around mean), spd.center() returns centered covariance matrices, target mean. tangent vectors can easily computed log-mapping centered observations: cases, user specifically interested differences relative reference condition (e.g. resting state scan), may preferable center reference scans subject aligned overall mean reference scan. example, might wish align condition “” dataset. case, constraints can specified using arguments from_constraints to_constraints. case, want center mean observations condition , set case to_constraints, condition applied within subjects, take observations condition computing subject means.  now cluster identical observations (0,0) condition , observations aligned across subjects. Note kind centering succeeded eliminating subject level clustering, since addition subject level differences, subject--task interactions also tend much larger pure task effects.","code":"data(bold) names(bold) #> [1] \"Subject\"   \"Condition\" \"Data\" # Note that it is almost always better to use some kind of regularized # covariance estimate, but we will use the sample covariance here for  # illustration. For higher dimensional problems, it is likely that the  # sample covariance will not be positive definite. covmats <- lapply(bold$Data, spd.estimate, method = \"sample\") D_uncentered <- proxy::dist(covmats, method = function(i,j)      spd.dist(i, j, method = \"riemannian\")) mds_uncentered <- cmdscale(D_uncentered) plot_data <- data.frame(Subject = bold$Subject,                         x = mds_uncentered[,1],                         y = mds_uncentered[,2]) ggplot(plot_data, aes(x = x, y = y, color = Subject)) +     geom_point(size = 3) + theme_classic() covmats_centered <- spd.center(d = bold, covmats = covmats, group_by = \"Subject\") centered_data <- spd.center(d = bold, covmats = covmats, group_by = 'Subject') covmats_centered <- centered_data$centered_covmats  D_centered <- proxy::dist(covmats_centered, method = function(i,j)      spd.dist(i, j, method = 'riemannian')) mds_centered <- cmdscale(D_centered) plot_data <- data.frame(Subject = bold$Subject,                         x = mds_centered[,1],                         y = mds_centered[,2]) ggplot(plot_data, aes(x = x, y = y, color = Subject)) +     geom_point(size = 3) + theme_classic() tanvecs <- lapply(centered_data$centered_covmats, spd.logmap,                    p = centered_data$target_covariance) from_constraints <- \"Condition == 'A'\" to_constraints   <- \"Condition == 'A'\" centered_data <- spd.center(d = bold, covmats = covmats, group_by = \"Subject\",                             from_constraints = from_constraints,                             to_constraints = to_constraints) covmats_centered <- centered_data$centered_covmats  D_centered <- proxy::dist(covmats_centered, method = function(i,j)      spd.dist(i, j, method = 'riemannian')) mds_centered <- cmdscale(D_centered)  plot_data <- data.frame(Subject = bold$Subject,                         Condition = bold$Condition,                         x = mds_centered[,1],                         y = mds_centered[,2]) ggplot(plot_data, aes(x = x, y = y, color = Subject, shape = Condition)) +     geom_point(size = 3, alpha = .5) + theme_classic()"},{"path":"areshenk-rpackages.github.io/spdm/articles/functions/centering/center_guide.html","id":"caveats","dir":"Articles > Functions > Centering","previous_headings":"","what":"Caveats","title":"Centering covariance matrices","text":"Although intend write formal description issue near future, covariance centering causes issues interpretation worth discussing high-level. Given covariance matrix \\(\\Sigma\\), entry \\((,j)\\) unambiguous interpretation covariance variables \\(\\) \\(\\). centering parallel transport – done spd.center – resulting entry \\((,j)\\) centered matrix \\(\\bar{\\Sigma}\\) actually linear combination entries \\(\\Sigma\\), doesn’t necessary unambiguous interpretation terms original variables. problem exacerbated transporting longer distances, primary motivation centering grand mean, since value minimizes average (squared) distance individual observations. possible explicitly quantify contributions covariance value centered covariances; general, principled method identifying much overall distortion occurred (although major current interest mine).","code":""},{"path":"areshenk-rpackages.github.io/spdm/articles/functions/centering/center_guide.html","id":"references","dir":"Articles > Functions > Centering","previous_headings":"","what":"References","title":"Centering covariance matrices","text":"Areshenkoff, C. N., Nashed, J. Y., Hutchison, R. M., Hutchison, M., Levy, R., Cook, D. J., … & Gallivan, J. P. (2021). Muting, fragmentation, functional brain networks general anesthesia. Neuroimage, 231, 117830. Gratton, C., Laumann, T. O., Nielsen, . N., Greene, D. J., Gordon, E. M., Gilmore, . W., … & Petersen, S. E. (2018). Functional brain networks dominated stable group individual factors, cognitive daily variation. Neuron, 98(2), 439-452.","code":""},{"path":"areshenk-rpackages.github.io/spdm/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":". Maintainer.","code":""},{"path":"areshenk-rpackages.github.io/spdm/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Areshenkoff CN (2024). spdm: Geometry-respecting analysis covariance matrices. R package version 1.2.0.","code":"@Manual{,   title = {spdm: Geometry-respecting analysis of covariance matrices},   author = {Corson N. Areshenkoff},   year = {2024},   note = {R package version 1.2.0}, }"},{"path":"areshenk-rpackages.github.io/spdm/index.html","id":"spdm-","dir":"","previous_headings":"","what":"Symmetric, positive-definite matrices in R","title":"Symmetric, positive-definite matrices in R","text":"spdm package contains routines analysis symmetric, positive-definite (SPD) matrices. spdm designed largely geometry-respecting manipulation analysis covariance matrices – , methods respect natural Riemannian-manifold structure space SPD matrices. Although methods geared towards analysis fMRI functional connectivity, package flexible domain agnostic. Features include: Regularized covariance estimation. Means, interpolation, distance measures covariance matrices. Translation covariance matrices parallel transport. Principal geodesic analysis, dimension reduction techniques space SPD matrices.","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/bold.html","id":null,"dir":"Reference","previous_headings":"","what":"FMRI BOLD data — bold","title":"FMRI BOLD data — bold","text":"Dataset contains fMRI BOLD data five subjects five resting-state conditions. Object data frame following fields: \"Subject\" Subject ID \"Condition\" Condition label \"Data\" 150 x 5 matrix containing standardized BOLD signal   5 cortical regions.","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/bold.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"FMRI BOLD data — bold","text":"Corson N. Areshenkoff areshenk@protonmail.com","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/is.spd.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if a matrix is symmetric and positive definite — is.spd","title":"Check if a matrix is symmetric and positive definite — is.spd","text":"Check matrix symmetric positive definite","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/is.spd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if a matrix is symmetric and positive definite — is.spd","text":"","code":"is.spd(..., tol = 1e-08)"},{"path":"areshenk-rpackages.github.io/spdm/reference/is.spd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if a matrix is symmetric and positive definite — is.spd","text":"... One numeric matrices tol Numerical tolerance checking symmetry positive definiteness","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/is.spd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check if a matrix is symmetric and positive definite — is.spd","text":"Boolean value indicating whether matrix symmetric positive definite","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/is.spd.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Check if a matrix is symmetric and positive definite — is.spd","text":"Function checks whether matrix x symmetric positive definite. Symmetry evaluated entrywise tolerance tol, differences smaller tol ignored. Positive-definiteness checked computing eigenvalues x using eigen, setting eigenvalues smaller tol absolute value zero, checking whether less equal zero.","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.center.html","id":null,"dir":"Reference","previous_headings":"","what":"Center a collection of covariance matrices — spd.center","title":"Center a collection of covariance matrices — spd.center","text":"Center dataset covariance matrices parallel transport","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.center.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Center a collection of covariance matrices — spd.center","text":"","code":"spd.center(d, covmats, group_by, from_constraints = \"\", to_constraints = \"\")"},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.center.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Center a collection of covariance matrices — spd.center","text":"d dataframe. See details. covmats optional list covariance matrices. group_by Variable d group . from_constraints Logical expression indicating subsets use group means. to_constraints Logical expression indicating subset use target mean.","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.center.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Center a collection of covariance matrices — spd.center","text":"named list containing centered covariance matrices, target mean covariance.","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.center.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Center a collection of covariance matrices — spd.center","text":"convenience wrapper implementing centering covariance matrix valued dataset parallel transport. essential goal procedure accomplish something like following: measured multiple covariance matrices per test subject, like align mean covariance subject common (overall) mean. accomplished 1. Computing grand mean covariance 2. Computing mean covariance subject 3. Projecting subjects' observations onto tangent space around mean 4. Parallel transporting tangent vectors along geodesic grand mean 5. Exponential mapping back onto space covariance matrices Consider neuroimaging experiment measure functional connectivity (covariance matrix) multiple conditions within subject, including baseline condition. Let covmats list covariance matrices, let d dataframe (nrows(d) = length(covmats)) containing columns Subject Condition. order center subjects' mean grand mean, user can specify group_by = \"Subject\" -- leaving constraints empty. user wished align subject baselines grand mean baseline, user can set from_constraints = \"Condition == 'Baseline'\" -- instructing baseline condition used construct subject meann -- set to_constraints way. generally, data split according group_by, group means computed using observations satisfying from_constraints. grand mean computed using observations satisfying to_constraints. Note , rather providing list covariance matrices, provided dataframe may include field named COVMATS containing list. case, covariance matrices used. Note provided, field COVMATS d overwritten.","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.correlation.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute (partial) correlations — spd.correlation","title":"Compute (partial) correlations — spd.correlation","text":"Transforms SPD matrix matrix partial correlations","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.correlation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute (partial) correlations — spd.correlation","text":"","code":"spd.correlation(x, method = \"correlation\")"},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.correlation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute (partial) correlations — spd.correlation","text":"x SPD matrix whitened method string specifying either \"correlation\" (default) orf \"partial\" correlation.","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.correlation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute (partial) correlations — spd.correlation","text":"symmetric, positive-definite matrix.","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.dimred.html","id":null,"dir":"Reference","previous_headings":"","what":"Dimension reduction — spd.dimred","title":"Dimension reduction — spd.dimred","text":"Wrapper function dimension reduction SPD matrices.","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.dimred.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dimension reduction — spd.dimred","text":"","code":"spd.dimred(X, method, ...)"},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.dimred.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Dimension reduction — spd.dimred","text":"X list SPD matrices. method Method dimension reduction. See details ... See details.","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.dimred.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Dimension reduction — spd.dimred","text":"\"congedo\": named list containing list `Xred` dimension  reduced covariance matrices, `n x k` matrix `Z` components. \"pga\": named list containing sample mean, components (unit  tangent vectors mean), associated eigenvalues, variance explained,  component scores observation.","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.dimred.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Dimension reduction — spd.dimred","text":"Allowable methods : \"congedo\": Method proposed Congedo et al. 2017. Maps set SPD  matrices onto set lower dimensional SPD matrices. Useful preprocessing  step techniques scale poorly dimension covariance  matrix. \"pga\": Principal geodesic analysis (PGA) using algorithm proposed  Fletcher Joshi (2004). Projects data onto tangent space around  sample mean, estimates principal geodesics applying PCA tangent vectors. Additional arguments may passed functions perform estimation. Specifically: \"congedo\": `k` gives dimension output space. default,  `k=2`. \"pga\": `k` gives dimension output space. default,  `k=2`.","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.dist.html","id":null,"dir":"Reference","previous_headings":"","what":"Distance between two symmetric, positive-definite matrices — spd.dist","title":"Distance between two symmetric, positive-definite matrices — spd.dist","text":"Function implements several distance measures symmetric, positive-definite matrices.","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.dist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Distance between two symmetric, positive-definite matrices — spd.dist","text":"","code":"spd.dist(x, y, method = \"euclidean\", ...)"},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.dist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Distance between two symmetric, positive-definite matrices — spd.dist","text":"x, y Symmetric, positive-definite matrices method distance measure. See details.","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.dist.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Distance between two symmetric, positive-definite matrices — spd.dist","text":"Allowable distance measures \"euclidean\": Frobenius norm difference x-y. \"logeuclidean\": Frobenius norm difference log(x)-log(y) tangent space.. \"cholesky\": Frobenius norm difference cholesky factors  x y. affinely invariant. \"riemannian\": Riemmanian distance proposed Barachant, et al. (2013) \"stein\": square root Jensen-Bregman log determinant divergence","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.estimate.html","id":null,"dir":"Reference","previous_headings":"","what":"Covariance estimation — spd.estimate","title":"Covariance estimation — spd.estimate","text":"Function implements several forms  covariance estimation.","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.estimate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Covariance estimation — spd.estimate","text":"","code":"spd.estimate(x, method = \"linshrink\", ...)"},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.estimate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Covariance estimation — spd.estimate","text":"x data matrix, rows observations columns variables method Method covariance estimation. See details ... Additional arguments passed estimation functions. See details.","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.estimate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Covariance estimation — spd.estimate","text":"covariance matrix","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.estimate.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Covariance estimation — spd.estimate","text":"Allowable estimation methods : \"sample\": ordinary sample covariance. Generally poor choice  anything low dimensional settings, guaranteed positive-definite. \"linshrink\": Linear shrinkage estimator proposed Ledoit Wolf (2004) \"nlshrink\": Non-linear shrinkage estimator proposed Ledoit Wolf (2012) \"glasso\": Graphical lasso (glasso) estimation using huge package.  Typically generates sparse estimates. Additional arguments may passed functions perform estimation. Specifically: \"sample\": Uses cov(x, ...) \"linshrink\": Uses nlshrink::linshrink_cov(x, ...) \"nlshrink\": Uses nlshrink::nlshrink_cov(x, ...) \"glasso\": Uses huge(x, method = 'glasso', cov.output = T, ...)  followed huge.select(x, ...). Note method  overridden, estimation methods return covariance estimates.  Additional arguments huge() huge.select()  prepended huge. select., respectively. cases, function generate warning estimated matrix positive definite.","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.expmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Projection from the tangent space — spd.expmap","title":"Projection from the tangent space — spd.expmap","text":"Function projects tangent vector x (symmetric matrix) point p onto space SPD matrices.","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.expmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Projection from the tangent space — spd.expmap","text":"","code":"spd.expmap(x, p = NULL)"},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.expmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Projection from the tangent space — spd.expmap","text":"x symmetric matrix p point whose tangent space x belongs","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.expmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Projection from the tangent space — spd.expmap","text":"symmetric, positive-definite matrix.","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.interpolate.html","id":null,"dir":"Reference","previous_headings":"","what":"Interpolation between two symmetric, positive-definite matrices — spd.interpolate","title":"Interpolation between two symmetric, positive-definite matrices — spd.interpolate","text":"Function smoothly interpolates two SPD matrices x y. interpolation parametrized t, t=0 returns x, t=1 returns y, t=.5 returns mean x y","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.interpolate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Interpolation between two symmetric, positive-definite matrices — spd.interpolate","text":"","code":"spd.interpolate(x, y, t, method = \"euclidean\", ...)"},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.interpolate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Interpolation between two symmetric, positive-definite matrices — spd.interpolate","text":"x, y Symmetric, positive-definite matrices t Interpolation parameter [0,infinity) method Type interpolation (see details)","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.interpolate.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Interpolation between two symmetric, positive-definite matrices — spd.interpolate","text":"Allowable distance measures \"euclidean\": Euclidean interpolation (1-t)x + ty \"logeuclidean\": Euclidean interpolation tangent space. \"riemannian\": Interpolation along geodesic path x y","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.logmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Projection onto the tangent space — spd.logmap","title":"Projection onto the tangent space — spd.logmap","text":"Function projects SPD matrix x onto tangent space point p","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.logmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Projection onto the tangent space — spd.logmap","text":"","code":"spd.logmap(x, p = NULL)"},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.logmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Projection onto the tangent space — spd.logmap","text":"x symmetric positive definite matrix p point whose tangent space project x","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.logmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Projection onto the tangent space — spd.logmap","text":"symmetric matrix.","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.mean.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the mean of a set of spd matrices — spd.mean","title":"Compute the mean of a set of spd matrices — spd.mean","text":"Function computes mean set symmetric positive-definite matrices. Several methods implemented, described Details.","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.mean.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the mean of a set of spd matrices — spd.mean","text":"","code":"spd.mean(x, method = \"euclidean\", ...)"},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.mean.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the mean of a set of spd matrices — spd.mean","text":"x list symmetric, positive-definite matrices method type mean compute. See details ... arguments. See details","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.mean.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the mean of a set of spd matrices — spd.mean","text":"mean matrices x.","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.mean.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute the mean of a set of spd matrices — spd.mean","text":"Function computes mean set symmetrix, positive-definite matrices. Several methods implemented: \"euclidean\": ordinary arithmetic mean -- sum matrices x,  divided number matrices. guaranteed spd matrix,  necessarily preserve spectral characteristics individual matrices. \"logeuclidean\": Computed taking arithmetic mean logarithms  matrices x, projecting back onto space spd matrices.  general, better behaved arithmetic mean. \"riemannian\": Riemmanian p-mean. Smoothly interpolates  harmonic mean p = -1 geometric mean p = 0  arithmetic mean p = 1.  approximated iteratively using fixed point algorithm described  Congedo, Barachant Koopaei (2017). Requies parameter p interval  [-1,1] specifying type mean, maximum error tolerance tol  (default .01), maximum number iterations (default 50). case  p = 0 approximated computing p-means -.1 .1,  returning midpoint using spd.interpolate(..., method = 'riemannian')","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.translate.html","id":null,"dir":"Reference","previous_headings":"","what":"Translation of a covariance matrix — spd.translate","title":"Translation of a covariance matrix — spd.translate","text":"Translates covariance matrix one basepoint another, Formally, projects covariance matrix onto tangent space one basepoint, transports tangent space second basepoint, projects back onto space SPD marices.","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.translate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Translation of a covariance matrix — spd.translate","text":"","code":"spd.translate(x, from, to = NULL, ...)"},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.translate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Translation of a covariance matrix — spd.translate","text":"x symmetric, positive-definite matrix SPD matrix whose tangent space x belong SPD matrix whose tangent space move x ... Additional arguments spd.transport","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.translate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Translation of a covariance matrix — spd.translate","text":"symmetric, positive-definite matrix","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.transport.html","id":null,"dir":"Reference","previous_headings":"","what":"Transport a tangent vector — spd.transport","title":"Transport a tangent vector — spd.transport","text":"Transports tangent vector one tangent space another.","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.transport.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Transport a tangent vector — spd.transport","text":"","code":"spd.transport(x, from, to = NULL, method = \"gl\", nsteps = NA)"},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.transport.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transport a tangent vector — spd.transport","text":"x tangent vector (symmetric matrix) SPD matrix whose tangent space x belongs SPD matrix whose tangent space move x method See details nsteps parallel transport, number steps along geodesic connecting ","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.transport.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Transport a tangent vector — spd.transport","text":"symmetric matrix -- tangent vector .","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.transport.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Transport a tangent vector — spd.transport","text":"Allowable method \"pt\": Parallel transport using Schild's ladder algorithm \"gl\": Transport B using GL(n) action \\(-> GAG'\\),  \\(G = B^{1/2}^{-1/2}\\)","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.vectorize.html","id":null,"dir":"Reference","previous_headings":"","what":"Vectorize and unvectorize a matrix — spd.vectorize","title":"Vectorize and unvectorize a matrix — spd.vectorize","text":"Function converts square symmetric matrix vector lower triangular elements + diagonal. Allows optional scaling -diagonal entries order preserve norm.","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.vectorize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Vectorize and unvectorize a matrix — spd.vectorize","text":"","code":"spd.vectorize(x, scaling = F)"},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.vectorize.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Vectorize and unvectorize a matrix — spd.vectorize","text":"x Either square matrix, vector contains lower triangular elements x (including diagonal elements) scaling TRUE, scales diagonal elements sqrt(2) preserve norm resulting vector","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.vectorize.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Vectorize and unvectorize a matrix — spd.vectorize","text":"input square matrix, converts lower triangular elements (including diagonal) numeric vector. input numeric vector, converts input symmetric matrix. Note , input vector, length must triangular number.","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.whiten.html","id":null,"dir":"Reference","previous_headings":"","what":"Covariance whitening transform — spd.whiten","title":"Covariance whitening transform — spd.whiten","text":"Whitens SPD matrix using procedure advocated Ng, et al. (2014)","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.whiten.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Covariance whitening transform — spd.whiten","text":"","code":"spd.whiten(x, p, unwhiten = F)"},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.whiten.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Covariance whitening transform — spd.whiten","text":"x SPD matrix whitened p SPD baseline whitening matrix unwhiten Logical. TRUE, reverses previously applied whitening transform.","code":""},{"path":"areshenk-rpackages.github.io/spdm/reference/spd.whiten.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Covariance whitening transform — spd.whiten","text":"symmetric, positive-definite matrix.","code":""}]
